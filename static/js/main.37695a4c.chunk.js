(window["webpackJsonplingvograph-admin"]=window["webpackJsonplingvograph-admin"]||[]).push([[4],{120:function(t,e,n){"use strict";n.d(e,"c",function(){return m}),n.d(e,"b",function(){return p});var r=n(45),a=n(0),o=n.n(a),c=n(84),i=n.n(c),l=n(54);function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(n,!0).forEach(function(e){Object(r.a)(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}const d=[{path:"/dashboard",name:"Dashboard",component:o.a.lazy(()=>n.e(17).then(n.bind(null,295)))},{path:"/users",exact:!0,name:"Users",component:o.a.lazy(()=>Promise.all([n.e(0),n.e(18)]).then(n.bind(null,296)))},{path:"/users/:id",exact:!0,name:"User Details",component:o.a.lazy(()=>Promise.all([n.e(3),n.e(10)]).then(n.bind(null,299)))},{path:"/terms",exact:!0,name:"Terms",component:o.a.lazy(()=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(11)]).then(n.bind(null,298)))},{path:"/terms/:id",exact:!0,name:"Term Details",component:o.a.lazy(()=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(7)]).then(n.bind(null,297)))}];function m(t){if(i()(!!t,"route name is not defined"),t.indexOf("/")>=0)return t;const e=d.find(e=>e.name.toLowerCase()===t.toLowerCase());if(e)return e.path;i()(!1,"bad route name ".concat(t))}function p(t){const e=function(t){const e=[];for(const n of d){const r=Object(l.f)(t.pathname,n);if(!r)continue;const a=u({},r,{route:n});if(r.exact)return[a];e.push(a)}return e}(t);if(e.length>0)return e[0]}e.a=d},122:function(t,e,n){"use strict";var r=n(0),a=n.n(r);e.a=()=>a.a.createElement("div",{className:"animated fadeIn pt-1 text-center"},"Loading...")},123:function(t,e,n){"use strict";n.d(e,"a",function(){return g});var r=n(117),a=n(0),o=n.n(a),c=n(37),i=n(293),l=n(290),s=n(291),u=n(292),d=n(170),m=n(16),p=n(66),f=n(40);const b=t=>{let e=t.className,n=t.title,b=t.content,g=t.okLabel,h=t.cancelLabel,v=t.apply,y=t.container;const O=Object(a.useState)(!0),j=Object(r.a)(O,2),w=j[0],E=j[1],C=()=>E(!1),x=()=>E(!w);return Object(a.useEffect)(()=>()=>{y&&Object(c.unmountComponentAtNode)(y),y&&y.parentNode&&y.parentNode.removeChild(y)}),o.a.createElement(i.a,{isOpen:w,toggle:x,className:e},o.a.createElement(l.a,{toggle:x},n||"Confirmation"),o.a.createElement(s.a,null,b),o.a.createElement(u.a,null,o.a.createElement(d.a,{color:"primary",onClick:()=>{new Promise(t=>{let e=v,n=[];Array.isArray(v)&&(e=v[0],n=v.slice(1)),Object(p.c)(e)?f.a.runSaga(function*(){const r=yield Object(m.a)(e,...n);t(r)}):t(e(...n))}).then(C)}},g||"OK"),"\xa0",o.a.createElement(d.a,{color:"secondary",onClick:x},h||"Cancel")))};function g(t){const e=document.createElement("div");document.body.appendChild(e),Object(c.render)(o.a.createElement(b,Object.assign({},t,{container:e})),e)}},165:function(t,e,n){"use strict";var r=n(123);n.d(e,"a",function(){return r.a})},180:function(t,e,n){t.exports=n(289)},257:function(t,e,n){},288:function(t,e,n){},289:function(t,e,n){"use strict";n.r(e);n(181),n(250);var r=n(0),a=n.n(r),o=n(37),c=n.n(o),i=n(65),l=n(119),s=n(41),u=(n(257),n(39)),d=n(40),m=n(63),p=n(54),f=n(122);n(288);const b=a.a.lazy(()=>Promise.all([n.e(1),n.e(8),n.e(19)]).then(n.bind(null,462))),g=a.a.lazy(()=>Promise.all([n.e(9),n.e(20)]).then(n.bind(null,454))),h=a.a.lazy(()=>n.e(12).then(n.bind(null,456))),v=a.a.lazy(()=>n.e(13).then(n.bind(null,457))),y=a.a.lazy(()=>n.e(14).then(n.bind(null,458))),O=a.a.lazy(()=>n.e(15).then(n.bind(null,459)));var j=class extends r.Component{render(){return a.a.createElement("div",null,a.a.createElement(a.a.Suspense,{fallback:Object(f.a)()},a.a.createElement(p.d,null,a.a.createElement(p.b,{exact:!0,path:"/login",name:"login",component:g}),a.a.createElement(p.b,{exact:!0,path:"/register",name:"register",component:h}),a.a.createElement(p.b,{exact:!0,path:"/401",name:"401",component:v}),a.a.createElement(p.b,{exact:!0,path:"/404",name:"404",component:y}),a.a.createElement(p.b,{exact:!0,path:"/500",name:"500",component:O}),a.a.createElement(p.b,{path:"/",name:"Home",component:b}))))}};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));d.a.runSaga(m.d),c.a.render(a.a.createElement(i.a,{store:d.a},a.a.createElement(l.a.Provider,{value:d.a},a.a.createElement(s.a,{history:u.a},a.a.createElement(j,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(t=>{t.unregister()})},39:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(32);const a=Object(r.a)({basename:"/admin"})},40:function(t,e,n){"use strict";var r=n(33),a=n(116),o=n(156),c=n(82),i=n(300),l=n(41),s=n(47),u=n(66);const d=c.a.Record({currentUser:void 0,cache:new c.a.Map}),m=Object(i.a)({[s.b]:(t,e)=>{const n=Object.assign({},e.payload);return n.avatar||(n.avatar=Object(u.b)(n.email)),t.set("currentUser",n)},[s.a]:(t,e)=>{let n=e.payload,r=n.key,a=n.value;const o=t.cache.set(r,a);return t.set("cache",o)}},d());var p=t=>Object(r.c)({common:m,router:Object(l.b)(t)}),f=n(39);const b=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||r.d;const g=function(){const t=Object(a.b)(),e=p(f.a),n=e({},{type:"@@INIT"}),c=Object(r.e)(e,n,b(Object(r.a)(t,Object(o.a)(f.a))));return c.runSaga=t.run,c.close=()=>c.dispatch(a.a),c}();e.a=g},47:function(t,e,n){"use strict";n.d(e,"b",function(){return a}),n.d(e,"a",function(){return o});var r=n(175);const a=Object(r.a)("SET_CURRENT_USER"),o=Object(r.a)("SET_CACHE")},48:function(t,e,n){"use strict";const r=new class{constructor(){this.listeners=[]}get value(){return localStorage.getItem("access_token")}set value(t){if(this.value!==t){t?localStorage.setItem("access_token",t):localStorage.removeItem("access_token");for(let e=0;e<this.listeners.length;e++){(0,this.listeners[e])(t)}}}subscribe(t){if("function"!==typeof t)throw new Error("Expected the listener to be a function.");let e=!0;return this.listeners.push(t),()=>{if(!e)return;e=!1;const n=this.listeners.indexOf(t);this.listeners.splice(n,1)}}};e.a=r},52:function(t,e,n){"use strict";n.d(e,"b",function(){return c}),n.d(e,"a",function(){return d});var r=n(19),a=n.n(r);const o=t=>t&&t.match(/^[^\s]+$/),c={translated_as:{label:"Translations",count:"translated_as_count"},definition:{label:"Definitions",count:"definition_count",reverseEdge:"definition_of"},definition_of:{label:"Definition for",count:"definition_of_count"},in:{label:"Used in",count:"in_count"},related:{label:"Related Terms",count:"related_count"},synonym:{label:"Synonyms",count:"synonym_count"},antonym:{label:"Antonyms",count:"antonym_count"}},i=["term","terms","audio","visual"].concat(Object.keys(c)),l="tag {\n        uid\n        text\n        lang\n        transcript@ru\n        transcript@en\n      }",s="{\n    uid\n    text\n    lang\n    transcript@ru\n    transcript@en\n    created_at\n    created_by {\n      uid\n      name\n    }\n    ".concat(l,"\n  }"),u="{\n    uid\n    url\n    source\n    content_type\n    views: count(see)\n    likes: count(like)\n    dislikes: count(dislike)\n    created_at\n    created_by {\n      uid\n      name\n    }\n    ".concat(l,"\n  }");function d(t){let e=t.kind,n=void 0===e?"terms":e,r=t.termUid,l=t.offset,d=void 0===l?0:l,m=t.limit,p=void 0===m?10:m,f=t.lang,b=t.searchString,g=t.tags,h=t.onlyTags,v=void 0!==h&&h;if(!n||!i.includes(n))throw new Error("invalid kind ".concat(n));if("term"===n&&!r)throw new Error("termUid is required");const y="has(Term)",O=r?"uid(".concat(r,")"):y,j="terms"===n,w="term"===n,E=j&&v?"has(Tag)":"",C={};const x="offset: ".concat(d,", first: ").concat(p),_=j?", ".concat(x):"",k=function(){if(!j)return"";const t=(b||"").trim();if(!t)return"";const e=o(t)&&t.length>=3;C.$searchString=t,e&&(C.$regexp="".concat(t,".*"));const n=["anyoftext(text, $searchString)",e?"regexp(text, /$regexp/i)":""].filter(t=>!!t);return n.length>1?"(".concat(n.join(" or "),")"):n[0]}();var S;const P=[y,E,f?'eq(lang, "'.concat(f,'")'):"",a.a.isEmpty(g)?"":(S=g.map(t=>"uid_in(tag, ".concat(t.uid,")")).join(" or "),"(".concat(S,")")),k].filter(t=>!!t).join(" and "),T=j?"@filter(".concat(P,")"):"",I=a.a.keys(C).map(t=>"".concat(t,": string")).join(),U=I?"query terms(".concat(I,") "):"",A=["audio","visual"],D=Object.keys(c).concat(A),L=D.map(t=>{const e=A.includes(t),r=n===t?"(".concat(x,")"):"(first: 10)",a=e?u:s;return"".concat(t," ").concat(r," ").concat(a)}).join("\n"),N=(t,e)=>(e||(e="".concat(t,"_count")),"".concat(e,": count(").concat(t,")")),R=w?D.map(t=>N(t)).join("\n"):"";return{text:"".concat(U,"{\n    terms(func: ").concat(O).concat(_,") ").concat(T," {\n      Tag\n      uid\n      text\n      lang\n      transcript@ru\n      transcript@en\n      created_at\n      created_by {\n        uid\n        name\n      }\n      tag {\n        uid\n        text\n        lang\n        transcript@ru\n        transcript@en\n      }\n      ").concat(L,"\n    }\n    count(func: ").concat(O,") ").concat(T," {\n      ").concat(w?"":N(j?"uid":n,"total"),"\n      ").concat(R,"\n    }\n  }").replace(/^\s*[\r\n]/gm,""),params:C}}},63:function(t,e,n){"use strict";var r=n(16),a=n(15),o=n(81),c=n(47),i=n(120),l=n(48);function*s(){for(;;){yield Object(r.d)(t=>t.type===a.b||t.type===a.a)}}function*u(t){const e=Object(i.c)(t);e&&(yield Object(r.b)(Object(a.d)(e)))}function*d(t,e,n){try{const i=yield Object(r.a)(o.d,t,e);(i.role||"").indexOf("admin")>=0?(yield Object(r.b)(Object(c.b)(i)),yield Object(r.a)(u,"/")):yield Object(r.a)(u,"/401")}catch(a){n(a)}}function*m(){l.a.value="",yield Object(r.a)(u,"/login")}function*p(){try{const e=yield Object(r.a)(o.e);yield Object(r.b)(Object(c.b)(e))}catch(t){yield Object(r.a)(u,"/login")}}function*f(){yield Object(r.c)(p),yield Object(r.c)(s)}n.d(e,"c",function(){return u}),n.d(e,"a",function(){return d}),n.d(e,"b",function(){return m}),n.d(e,"d",function(){return f})},66:function(t,e,n){"use strict";n.d(e,"b",function(){return i}),n.d(e,"c",function(){return l}),n.d(e,"a",function(){return u});var r=n(19),a=n(172),o=n.n(a);const c=/^[0-9a-f]{32}$/;function i(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:80;if(!t)return;const n=(t=t.trim().toLowerCase()).match(c)?t:o()(t);return"https://www.gravatar.com/avatar/".concat(n,".jpg?s=").concat(e,"&d=mp")}function l(t){const e=t.constructor;return!!e&&("GeneratorFunction"===e.name||"GeneratorFunction"===e.displayName||function(t){return Object(r.isFunction)(t.next)&&Object(r.isFunction)(t.throw)}(e.prototype))}const s=t=>{try{return new DOMException(t,"AbortError")}catch(e){const n=new Error(t);return n.name="AbortError",n}};function u(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return new Promise((n,r)=>{const a=setTimeout(()=>{n(!0)},t);if(e){const t=()=>{e.signal.removeEventListener("abort",t),clearTimeout(a),r(s("timer aborted"))};e.signal.addEventListener("abort",t)}})}},81:function(t,e,n){"use strict";n.d(e,"a",function(){return h}),n.d(e,"d",function(){return y}),n.d(e,"e",function(){return S}),n.d(e,"f",function(){return P}),n.d(e,"i",function(){return I}),n.d(e,"g",function(){return U}),n.d(e,"h",function(){return A}),n.d(e,"c",function(){return D}),n.d(e,"b",function(){return L});var r=n(45),a=n(118),o=n(19),c=n.n(o),i=n(23),l=n(173),s=(n(278),n(165)),u=n(63),d=n(40),m=n(48),p=n(39),f=n(52);function b(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function g(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?b(n,!0).forEach(function(e){Object(r.a)(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):b(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}const h=11;function v(t){return c.a.isString(t)?t:t.error||t.error_message}async function y(t,e){const n=await i({url:"/api/login",method:"POST",auth:{username:t,password:e}});return m.a.value=n.data.token,S()}function O(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=t.abortController;return g({},Object(a.a)(t,["abortController"]),{},e?function(t){if(!t){const e=p.a.location.pathname;t=new AbortController,p.a.listen(n=>{n.pathname!==e&&t.abort()})}const e=i.CancelToken.source();return t.signal.addEventListener("abort",()=>{e.cancel("canceled")}),{cancelToken:e.token}}(n):{})}function j(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=O(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{});return i.get(t,g({params:e},n)).then(t=>t.data)}function w(t,e){const n=O(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{});return i.put(t,e,n).then(t=>t.data)}function E(t){const e=O(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},!1);return i.delete(t,g({},e))}function C(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=O(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{});return i.post("/api/query",t,g({params:e},n)).then(t=>t.data)}function x(t){if(c.a.isString(t))return t;const e=t=>t.startsWith("0x")?"<".concat(t,">"):t,n=(t,n,r)=>"".concat(e(t)," <").concat(n,"> ").concat(e(r)," .");if(c.a.isArray(t)){if(3!==t.length||t.some(t=>!t))throw new Error("unexpected nquad array");return n(t[0],t[1],t[2])}if(c.a.isObject(t)){if(!t.subject||!t.predicate||!t.object)throw new Error("invalid nquad object");return n(t.subject,t.predicate,t.object)}throw new Error("unexpected nquad value")}function _(t){if(t){if(c.a.isString(t))return t;if(!c.a.isArray(t))throw new Error("unexpected value");return t.map(x).join("\n")}}function k(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const a={set:_(t),delete:_(e)};if(!a.set&&!a.delete)throw new Error("please specify set or delete mutations");const o=O(n,r);return i.post("/api/nquads",a,o).then(t=>t.data)}function S(){return j("/api/me")}function P(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h;const n=new URLSearchParams(t),r=parseInt(n.get("page"),10),a=parseInt(n.get("limit"),10);return{page:isNaN(r)||r<=0?1:r,limit:isNaN(a)||a<=0?e:r}}function T(t,e){let n=e.abortController,r=e.page,a=void 0===r?1:r,o=e.limit,c=void 0===o?h:o;const i=(a-1)*c,l=new URLSearchParams;return l.append("offset",i),l.append("limit",c),j(t,l,{abortController:n})}i.defaults.headers.common.Accept="application/json",i.defaults.headers.common["Content-Type"]="application/json",Object(l.loadProgressBar)(),i.interceptors.request.use(t=>(m.a.value&&!t.auth&&(t.headers.Authorization="Bearer ".concat(m.a.value)),t)),i.interceptors.response.use(t=>t,function(t){const e=c.a.get(t,"response.status");if(401===e){if(window.location.pathname.endsWith("/login"))throw new Error(v(t.response.data));Object(s.a)({title:"Session Expired",content:"Your session has expired. Would you like to be redirected to the login page?",warning:!0,okLabel:"Yes",cancelLabel:"No",apply:[u.c,"/login"]})}else if(404===e)d.a.runSaga(u.c,"/404");else{if(!(e>=500))return Promise.reject(t);alert(v(t.response.data))}});const I={get(t){let e=t.id,n=t.abortController;return j("/api/data/user/".concat(e),{},{abortController:n})},list(t){let e=t.abortController,n=t.page,r=void 0===n?1:n,a=t.limit;return T("/api/data/user/list",{abortController:e,page:r,limit:void 0===a?h:a})}},U={get(t){let e=t.id,n=t.abortController;return j("/api/data/tag/".concat(e),{},{abortController:n})},list(t){let e=t.abortController,n=t.page,r=void 0===n?1:n,a=t.limit;return T("/api/data/tag/list",{abortController:e,page:r,limit:void 0===a?h:a})},update(t){let e=t.id,n=t.data,r=t.abortController;return w("/api/data/tag/".concat(e),n,{abortController:r})},updateObjectTags(t){let e=t.id,n=t.oldTags,r=void 0===n?[]:n,a=t.newTags,o=void 0===a?[]:a,c=t.abortController;const i=r.filter(t=>!o.some(e=>e.uid===t.uid));return k(o.filter(t=>!r.some(e=>e.uid===t.uid)).map(t=>[e,"tag",t.uid]),i.map(t=>[e,"tag",t.uid]),{abortController:c})}},A={create:t=>(function(t,e){const n=O(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{});return i.post(t,e,n).then(t=>t.data)})("/api/data/term",t.data,{abortController:t.abortController}),get(t){let e=t.id,n=t.abortController;const r=Object(f.a)({kind:"term",termUid:e});return C(r.text,r.params,{abortController:n}).then(t=>{const e=t.terms[0];return e?(Object.assign(e,t.count[0]),e):null})},getAudio(t){let e=t.id,n=t.abortController,r=t.offset,a=void 0===r?0:r,o=t.limit,c=void 0===o?h:o;const i=Object(f.a)({kind:"audio",termUid:e,offset:a,limit:c});return C(i.text,i.params,{abortController:n}).then(t=>{const e=t.terms[0];return e?{items:e.audio,total:t.count[0].total}:null})},list(t){let e=t.abortController,n=t.termId,r=t.kind,a=void 0===r?"terms":r,o=t.page,c=void 0===o?1:o,i=t.limit,l=void 0===i?h:i,s=t.lang,u=t.searchString,d=t.tags,m=t.onlyTags,p=void 0!==m&&m;const b=(c-1)*l,g=Object(f.a)({kind:a,termUid:n,offset:b,limit:l,lang:s,searchString:u,tags:d,onlyTags:p});return C(g.text,g.params,{abortController:e}).then(t=>({items:t.terms,total:t.count[0].total,page:c,limit:l}))},update(t){let e=t.id,n=t.data,r=t.abortController;return w("/api/data/term/".concat(e),n,{abortController:r})},async addVisualURL(t){let e=t.id,n=t.url,r=t.abortController;const a=[[e,"visual",(await j("/api/fileproxy/?url=".concat(encodeURIComponent(n),"&remote=true"),{},{abortController:r})).uid]];return await k(a,void 0,{abortController:r}),await j("/api/data/term/".concat(e))},unlinkRelated(t){let e=t.termId,n=t.id,r=t.edge;return k(void 0,[[e,r,n],[n,f.b[r].reverseEdge||r,e]],{},!1)},linkRelated(t){let e=t.termId,n=t.id,r=t.edge;return k([[e,r,n],[n,f.b[r].reverseEdge||r,e]],void 0,{},!1)},toggleTagType(t){let e=t.termId,n=t.isTag;const r=[e,"Tag",n?'""':"*"];return k(n?[r]:void 0,n?void 0:[r],{},!1)}},D={delete(t){let e=t.id;return E("/api/data/file/".concat(e))},async deleteAudio(t){let e=t.termId,n=t.id;try{const t=[e,"audio",n];await k(void 0,[t],{},!1)}catch(r){throw r}await E("/api/data/file/".concat(n))},unlinkVisual(t){let e=t.termId;return k(void 0,t.visual.map(t=>[e,"visual",t.uid]),{},!1)}},L={searchAudio(t){let e=t.lang,n=t.text;return j("/api/pyadmin/search/audio/".concat(decodeURIComponent(n)),{lang:e})},async restoreRemoteAudio(t){let e=t.term,n=t.userId;const r=new Set(c.a.map(e.audio,t=>t.url)),a=(await L.searchAudio({lang:e.lang,text:e.text})).mp3.filter(t=>!r.has(t.url)),o=[],i=(new Date).toISOString();for(let c=0;c<a.length;c++){const t="_:a".concat(c+1),r=new URL(a[c].url).hostname;o.push([t,"File",'""'],[t,"created_at",'"'.concat(i,'"^^<xs:dateTime>')],[t,"created_by",n],[t,"url",'"'.concat(a[c].url,'"')],[t,"source",'"'.concat(r,'"')],[e.uid,"audio",t])}await k(o,void 0)}}}},[[180,5,6]]]);
//# sourceMappingURL=main.37695a4c.chunk.js.map